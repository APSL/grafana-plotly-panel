{"version":3,"sources":["../src/module.js"],"names":["MetricsPanelCtrl","_","moment","angular","Plotly","PlotlyPanelCtrl","$scope","$injector","$q","$rootScope","$timeout","$window","timeSrv","uiSegmentSrv","q","sizeChanged","initalized","$tooltip","$","dcfg","settings","type","mode","displayModeBar","line","color","width","dash","shape","marker","size","symbol","colorscale","showscale","color_option","layout","autosize","showlegend","legend","dragmode","hovermode","plot_bgcolor","paper_bgcolor","font","family","margin","t","b","l","r","xaxis","showgrid","zeroline","gridcolor","range","yaxis","scene","title","zaxis","panel","pconfig","extend","cfg","trace","x","y","z","events","on","onInitEditMode","bind","onRender","onDataReceived","onDataError","onPanelInitalized","onRefresh","element","onResize","onConfigChanged","err","seriesList","render","console","log","graph","redraw","addEditorTab","editorTabIndex","refresh","segs","newSegment","value","s","options","showLink","displaylogo","modeBarButtonsToRemove","data","rect","getBoundingClientRect","old","height","newPlot","i","points","length","idx","pointNumber","ts","msg","toPrecision","appEvent","dashboard","formatDate","xxx","mouse","pt","body","html","place_tt","pageX","pageY","detach","min","Number","MAX_SAFE_INTEGER","max","MIN_SAFE_INTEGER","Math","from","utc","to","setTime","Plots","purge","innerHTML","resize","dataList","srcX","datapoints","srcY","srcZ","target","srcColor","is3d","len","push","scope","elem","attrs","ctrl","find","evt","txt","forEach","val","when","templateUrl"],"mappings":"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","file":"module.js","sourcesContent":["\r\nimport {MetricsPanelCtrl} from  'app/plugins/sdk';\r\n\r\nimport _ from 'lodash';\r\nimport moment from 'moment';\r\nimport angular from 'angular';\r\n\r\nimport * as Plotly from './external/plotly';\r\n\r\nclass PlotlyPanelCtrl extends MetricsPanelCtrl {\r\n\r\n  constructor($scope, $injector, $q, $rootScope, $timeout, $window, timeSrv, uiSegmentSrv) {\r\n    super($scope, $injector);\r\n\r\n    this.$rootScope = $rootScope;\r\n    this.timeSrv = timeSrv;\r\n    this.uiSegmentSrv = uiSegmentSrv;\r\n    this.q = $q;\r\n\r\n    this.sizeChanged = true; \r\n    this.initalized = false;\r\n    \r\n    this.$tooltip = $('<div id=\"tooltip\" class=\"graph-tooltip\">');\r\n\r\n\r\n    var dcfg = {\r\n      settings: {\r\n        type: 'scatter',\r\n        mode: 'lines+markers',\r\n        displayModeBar: false,\r\n        line: {\r\n          color : '#005f81',\r\n          width : 6,\r\n          dash  : 'solid',\r\n          shape : 'linear'\r\n        },\r\n        marker: {\r\n          size: 30,\r\n          symbol: 'circle',\r\n          color: '#33B5E5',\r\n          colorscale: 'YIOrRd',\r\n          line: {\r\n            color: '#DDD',\r\n            width: 0\r\n          },\r\n          showscale: true\r\n        },\r\n        color_option: 'ramp'\r\n      },\r\n      layout: {\r\n        autosize: false,\r\n        showlegend: false,\r\n        legend: {\"orientation\": \"v\"},\r\n        dragmode: 'lasso', // (enumerated: \"zoom\" | \"pan\" | \"select\" | \"lasso\" | \"orbit\" | \"turntable\" ) \r\n        hovermode: 'closest',\r\n        plot_bgcolor: \"#1f1d1d\",\r\n        paper_bgcolor: 'rgba(0,0,0,0)', // transparent?\r\n        font: {\r\n          color: '#D8D9DA',\r\n          family: '\"Open Sans\", Helvetica, Arial, sans-serif' \r\n        },\r\n        margin: {\r\n          t: 0,\r\n          b: 45,\r\n          l: 65,\r\n          r: 20,\r\n        },\r\n        xaxis: {\r\n          showgrid: true,\r\n          zeroline: false,\r\n          type: 'linear',\r\n          gridcolor: '#444444',\r\n          range: [null, null]\r\n        },\r\n        yaxis: {\r\n          showgrid: true,\r\n          zeroline: false,\r\n          type: 'linear',\r\n          gridcolor: '#444444',\r\n          range: [null, null]\r\n        },\r\n        scene: {\r\n          xaxis:{title: 'X AXIS'},\r\n          yaxis:{title: 'Y AXIS'},\r\n          zaxis:{title: 'Z AXIS'},\r\n        },\r\n      }\r\n    };\r\n\r\n    // Make sure it has the default settings (may have more!)\r\n    this.panel.pconfig = $.extend(true, dcfg, this.panel.pconfig );\r\n\r\n    var cfg = this.panel.pconfig;\r\n    this.trace = {\r\n      x: [],\r\n      y: [],\r\n      z: []\r\n    };\r\n    this.layout = $.extend(true, {}, this.panel.pconfig.layout );\r\n\r\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\r\n    this.events.on('render', this.onRender.bind(this));\r\n    this.events.on('data-received', this.onDataReceived.bind(this));\r\n    this.events.on('data-error', this.onDataError.bind(this));\r\n    this.events.on('panel-initialized', this.onPanelInitalized.bind(this));\r\n    this.events.on('refresh', this.onRefresh.bind(this));\r\n\r\n\r\n    angular.element($window).bind('resize', this.onResize.bind(this) );\r\n\r\n    this.onConfigChanged();\r\n  }\r\n\r\n  onResize() {\r\n    this.sizeChanged = true;\r\n  }\r\n\r\n  onDataError(err) {\r\n    this.seriesList = [];\r\n    this.render([]);\r\n    console.log(\"onDataError\", err);\r\n  }\r\n\r\n  onRefresh() {\r\n    console.log(\"onRefresh()\")\r\n\r\n    if(this.graph && this.initalized) {\r\n      Plotly.redraw(this.graph);\r\n    }\r\n  }\r\n\r\n  onInitEditMode() {\r\n    this.addEditorTab('Options', 'public/plugins/natel-plotly-panel/editor.html',1);\r\n    this.editorTabIndex = 1;\r\n    this.refresh();\r\n    this.segs = {\r\n      symbol: this.uiSegmentSrv.newSegment({value: this.panel.pconfig.settings.marker.symbol })\r\n    };\r\n  }\r\n\r\n  onSegsChanged() {\r\n    this.panel.pconfig.settings.marker.symbol = this.segs.symbol.value;\r\n    this.onConfigChanged();\r\n\r\n    console.log( this.segs.symbol, this.panel.pconfig );\r\n  }\r\n\r\n  onPanelInitalized() {\r\n    console.log(\"onPanelInitalized()\")\r\n  }\r\n\r\n  onRender() {\r\n\r\n    if(!this.initalized) {\r\n      var s = this.panel.pconfig.settings;\r\n\r\n      var options = {\r\n        showLink: false, \r\n        displaylogo: false,\r\n        displayModeBar: s.displayModeBar,\r\n        modeBarButtonsToRemove: ['sendDataToCloud'] //, 'select2d', 'lasso2d']\r\n      }\r\n\r\n      var data = [this.trace];\r\n      var rect = this.graph.getBoundingClientRect();\r\n\r\n      var old = this.layout;\r\n      this.layout = $.extend(true, {}, this.panel.pconfig.layout );\r\n      this.layout.height = this.height;\r\n      this.layout.width = rect.width;\r\n      if(old) {\r\n        this.layout.xaxis.title = old.xaxis.title;\r\n        this.layout.yaxis.title = old.yaxis.title;\r\n      }\r\n\r\n      Plotly.newPlot(this.graph, data, this.layout, options);\r\n\r\n      this.graph.on('plotly_click', (data) => {\r\n        for(var i=0; i < data.points.length; i++){\r\n          var idx = data.points[i].pointNumber;\r\n          var ts = this.trace.ts[idx];\r\n         // console.log( 'CLICK!!!', ts, data );\r\n          var msg = data.points[i].x.toPrecision(4) + \", \"+data.points[i].y.toPrecision(4);\r\n          this.$rootScope.appEvent('alert-success', [msg, '@ ' + this.dashboard.formatDate(moment(ts))]);\r\n        }\r\n      });\r\n\r\n      if(false) {\r\n        this.graph.on('plotly_hover', (data, xxx) => {\r\n          console.log( 'HOVER!!!', data, xxx, this.mouse );\r\n          if(data.points.length>0) {\r\n            var idx = 0;\r\n            var pt = data.points[idx];\r\n\r\n            var body = '<div class=\"graph-tooltip-time\">'+ pt.pointNumber +'</div>';\r\n            body += \"<center>\";\r\n            body += pt.x + ', '+pt.y;\r\n            body += \"</center>\";\r\n\r\n            this.$tooltip.html( body ).place_tt( this.mouse.pageX + 10, this.mouse.pageY );\r\n          }\r\n        }).on('plotly_unhover', (data) => {\r\n          this.$tooltip.detach(); \r\n        });\r\n      }\r\n\r\n      this.graph.on('plotly_selected',  (data) => {\r\n\r\n        if(data.points.length == 0) {\r\n          console.log( \"Nothign Selected\", data)\r\n          return;\r\n        }\r\n\r\n        console.log( \"SELECTED\", data)\r\n\r\n        var min = Number.MAX_SAFE_INTEGER;\r\n        var max = Number.MIN_SAFE_INTEGER;\r\n\r\n        for(var i=0; i < data.points.length; i++){\r\n          var idx = data.points[i].pointNumber;\r\n          var ts = this.trace.ts[idx];\r\n          min = Math.min( min, ts);\r\n          max = Math.max( max, ts);\r\n        }\r\n\r\n        min -= 1000;\r\n        max += 1000;\r\n\r\n        var range = {from: moment.utc(min), to: moment.utc(max) };\r\n\r\n        console.log( 'SELECTED!!!', min, max, data.points.length, range ); \r\n\r\n        this.timeSrv.setTime(range);\r\n\r\n        // rebuild the graph after query\r\n        if(this.graph) {\r\n          Plotly.Plots.purge(this.graph);\r\n          this.graph.innerHTML = '';\r\n          this.initalized = false;\r\n        }\r\n      });\r\n    }\r\n    else {\r\n      Plotly.redraw(this.graph);\r\n    }\r\n\r\n    if(this.sizeChanged && this.graph && this.layout) {\r\n      var rect = this.graph.getBoundingClientRect();\r\n      this.layout.width = rect.width;\r\n      Plotly.Plots.resize(this.graph);\r\n    }\r\n\r\n    this.sizeChanged = false; \r\n    this.initalized = true;\r\n    console.log(\"onRender\");\r\n  }\r\n\r\n  onDataReceived(dataList) {\r\n    this.trace.x = [];\r\n    this.trace.y = [];\r\n    this.trace.z = [];\r\n    this.trace.ts = [];\r\n\r\n    if(dataList.length < 2) {\r\n      console.log( \"No data\", dataList );\r\n    }\r\n    else {\r\n   //   console.log( \"plotly data\", dataList);\r\n\r\n      var cfg = this.panel.pconfig;\r\n\r\n      var srcX = dataList[0].datapoints;\r\n      var srcY = dataList[1].datapoints;\r\n      \r\n      if(srcX.length != srcY.length) {\r\n        throw \"Metrics must have the same count! (x!=y)\";\r\n      }\r\n\r\n      var srcZ = null;\r\n      if(cfg.settings.type == 'scatter3d') {\r\n        srcZ = dataList[2].datapoints;\r\n        if(srcZ.length != srcY.length) {\r\n          throw \"Metrics must have the same count! (z!=y)\";\r\n        }\r\n        this.layout.scene.xaxis.title = dataList[0].target;\r\n        this.layout.scene.yaxis.title = dataList[1].target;\r\n        this.layout.scene.zaxis.title = dataList[2].target;\r\n\r\n        console.log( \"3D\", this.layout);\r\n\r\n      }\r\n      else {\r\n        this.layout.xaxis.title = dataList[0].target;\r\n        this.layout.yaxis.title = dataList[1].target;\r\n      }\r\n\r\n      var srcColor = null;\r\n      if (cfg.settings.color_option == 'data') {\r\n        var is3d = (cfg.settings.type == 'scatter3d');\r\n        if (dataList.length < (is3d ? 4 : 3)) {\r\n          throw \"Need extra metric for color!\";\r\n        }\r\n        srcColor = dataList[is3d ? 3 : 2].datapoints;\r\n      }\r\n\r\n      this.trace.marker = $.extend(true, {}, cfg.settings.marker);\r\n      this.trace.line = $.extend(true, {}, cfg.settings.line);\r\n      if(cfg.settings.color_option == 'ramp' || cfg.settings.color_option == 'data') {\r\n        this.trace.marker.color = [];\r\n      }\r\n\r\n      var len = srcX.length;\r\n      for(var i=0;i<len; i++) {\r\n        this.trace.ts.push( srcX[i][1] );\r\n        this.trace.x.push( srcX[i][0] );\r\n        this.trace.y.push( srcY[i][0] );\r\n        if(cfg.settings.color_option == 'ramp') {\r\n          this.trace.marker.color.push(i);\r\n        } else if (srcColor) {\r\n          this.trace.marker.color.push(srcColor[i][0]);\r\n        }\r\n        if( srcZ) {\r\n          this.trace.z.push( srcZ[i][0] );\r\n        }\r\n      }\r\n    }\r\n    this.render();\r\n  }\r\n\r\n  onConfigChanged() {\r\n    console.log( \"Config changed...\");\r\n    if(this.graph) {\r\n      Plotly.Plots.purge(this.graph);\r\n      this.graph.innerHTML = '';\r\n      this.initalized = false;\r\n    }\r\n\r\n    var cfg = this.panel.pconfig;\r\n    this.trace.type = cfg.settings.type;\r\n    this.trace.mode = cfg.settings.mode;\r\n    this.refresh();\r\n  }\r\n\r\n  link(scope, elem, attrs, ctrl) {\r\n    this.graph = elem.find('.plotly-spot')[0];\r\n    this.initalized = false;\r\n    elem.on( 'mousemove', (evt) => {\r\n      this.mouse = evt;\r\n    });\r\n  }\r\n\r\n  //---------------------------\r\n\r\n\r\n  getSymbolSegs()\r\n  {\r\n    var txt = [\r\n\"circle\",\"circle-open\",\"circle-dot\",\"circle-open-dot\",\r\n\"square\",\"square-open\",\"square-dot\",\"square-open-dot\",\r\n\"diamond\",\"diamond-open\",\r\n\"diamond-dot\",\"diamond-open-dot\",\r\n\"cross\",\"cross-open\",\r\n\"cross-dot\",\"cross-open-dot\",\r\n\"x\",\"x-open\",\"x-dot\",\"x-open-dot\",\r\n\"triangle-up\",\r\n\"triangle-up-open\",\r\n\"triangle-up-dot\",\r\n\"triangle-up-open-dot\",\r\n\"triangle-down\",\r\n\"triangle-down-open\",\r\n\"triangle-down-dot\",\r\n\"triangle-down-open-dot\",\r\n\"triangle-left\",\r\n\"triangle-left-open\",\r\n\"triangle-left-dot\",\r\n\"triangle-left-open-dot\",\r\n\"triangle-right\",\r\n\"triangle-right-open\",\r\n\"triangle-right-dot\",\r\n\"triangle-right-open-dot\",\r\n\"triangle-ne\",\r\n\"triangle-ne-open\",\r\n\"triangle-ne-dot\",\r\n\"triangle-ne-open-dot\",\r\n\"triangle-se\",\r\n\"triangle-se-open\",\r\n\"triangle-se-dot\",\r\n\"triangle-se-open-dot\",\r\n\"triangle-sw\",\r\n\"triangle-sw-open\",\r\n\"triangle-sw-dot\",\r\n\"triangle-sw-open-dot\",\r\n\"triangle-nw\",\r\n\"triangle-nw-open\",\r\n\"triangle-nw-dot\",\r\n\"triangle-nw-open-dot\",\r\n\"pentagon\",\r\n\"pentagon-open\",\r\n\"pentagon-dot\",\r\n\"pentagon-open-dot\",\r\n\"hexagon\",\r\n\"hexagon-open\",\r\n\"hexagon-dot\",\r\n\"hexagon-open-dot\",\r\n\"hexagon2\",\r\n\"hexagon2-open\",\r\n\"hexagon2-dot\",\r\n\"hexagon2-open-dot\",\r\n\"octagon\",\r\n\"octagon-open\",\r\n\"octagon-dot\",\r\n\"octagon-open-dot\",\r\n\"star\",\r\n\"star-open\",\r\n\"star-dot\",\r\n\"star-open-dot\",\r\n\"hexagram\",\r\n\"hexagram-open\",\r\n\"hexagram-dot\",\r\n\"hexagram-open-dot\",\r\n\"star-triangle-up\",\r\n\"star-triangle-up-open\",\r\n\"star-triangle-up-dot\",\r\n\"star-triangle-up-open-dot\",\r\n\"star-triangle-down\",\r\n\"star-triangle-down-open\",\r\n\"star-triangle-down-dot\",\r\n\"star-triangle-down-open-dot\",\r\n\"star-square\",\r\n\"star-square-open\",\r\n\"star-square-dot\",\r\n\"star-square-open-dot\",\r\n\"star-diamond\",\r\n\"star-diamond-open\",\r\n\"star-diamond-dot\",\r\n\"star-diamond-open-dot\",\r\n\"diamond-tall\",\r\n\"diamond-tall-open\",\r\n\"diamond-tall-dot\",\r\n\"diamond-tall-open-dot\",\r\n\"diamond-wide\",\r\n\"diamond-wide-open\",\r\n\"diamond-wide-dot\",\r\n\"diamond-wide-open-dot\",\r\n\"hourglass\",\r\n\"hourglass-open\",\r\n\"bowtie\",\r\n\"bowtie-open\",\r\n\"circle-cross\",\r\n\"circle-cross-open\",\r\n\"circle-x\",\r\n\"circle-x-open\",\r\n\"square-cross\",\r\n\"square-cross-open\",\r\n\"square-x\",\r\n\"square-x-open\",\r\n\"diamond-cross\",\r\n\"diamond-cross-open\",\r\n\"diamond-x\",\r\n\"diamond-x-open\",\r\n\"cross-thin\",\r\n\"cross-thin-open\",\r\n\"x-thin\",\r\n\"x-thin-open\",\r\n\"asterisk\",\r\n\"asterisk-open\",\r\n\"hash\",\r\n\"hash-open\",\r\n\"hash-dot\",\r\n\"hash-open-dot\",\r\n\"y-up\",\r\n\"y-up-open\",\r\n\"y-down\",\r\n\"y-down-open\",\r\n\"y-left\",\r\n\"y-left-open\",\r\n\"y-right\",\r\n\"y-right-open\",\r\n\"line-ew\",\r\n\"line-ew-open\",\r\n\"line-ns\",\r\n\"line-ns-open\",\r\n\"line-ne\",\r\n\"line-ne-open\",\r\n\"line-nw\",\r\n\"line-nw-open\"\r\n    ];\r\n\r\n    var segs = [];\r\n    _.forEach(txt, (val) => {\r\n      segs.push( this.uiSegmentSrv.newSegment( val ) );\r\n    });\r\n    return this.q.when( segs );\r\n  }\r\n}\r\nPlotlyPanelCtrl.templateUrl = 'module.html';\r\n\r\nexport {\r\n  PlotlyPanelCtrl as PanelCtrl\r\n};\r\n\r\n\r\n"]}